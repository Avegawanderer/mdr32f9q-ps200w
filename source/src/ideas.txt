
Взаимодействие по УАРТ:

Реакция на команду (варианты)
	а. минимальное подтверждение в виде короткого сообщения ОК. 
		а.1. Инициатор обмена по уарт отправляет новую команду и сам считывает обновленное значение (модель pull)
		а.2. После обработки команды генерируется сообщение об обновлении даннного параметра со значением параметра или без него и рассылается всем наблюдателям.
	б. подтверждение с отправкой обновленного реального значения параметра после обработки команды:
		б.1. RX таск отправляет команду, ждет пока таск-адресат установит квитирующий семафор, потом читает новое значение параметра и передает его обратно по УАРТ.
		б.2. RX таск отправляет команду, ждет семафор, в сообщение есть место для заполнения таском-адресатом значением параметром после обработки. Адресат обрабатыват команду,
			записывает туда новое значение и устанавливает семафор.
		В случае б не обязательно уведомлять таск, который иницировал обновление параметра - он уже получил новое значение.

Протокол с подтверждением.
Ведется двусторонний обмен. ПК инициирует активность, передавая какую-то команду. БП принимает команду, выполняет ее и возвращает пакет ACK, возможно
включая новое значение параметра. При этом спецификации значения, указанные в команде, не передаются. Возможно передается несколько параметров, которые взаимосвязаны.
БП может также инициировать обмен, посылая сообщения INFO - для уведомления ПК о изменении своего состояния. В таких пакетах указываются все спецификации,
необходимые для однозначной идентификации события. БП обязан всегда отвечать на команду от ПК. Возможен смешаный поток пакетов ACK и INFO, но следующая команда
не отправляется БП пока не будет получен ACK к текущей.
+ несколько меньший поток данных по УАРТ
- сложнее ПО на устройстве - нужно иметь разные процедуры для отправки одного и того же параметра как ACK и INFO
* НЕЛЬЗЯ использовать PUSH-протокол - новое PUSH-уведомление со значением может прийти раньше, чем пакет ACK команды, влияющей на этот же параметр и также содержащий значение.
	Значение в пакете ACK ПК получит последним, но данные в нем будут устаревшие

Протокол без подтверждения.
Аналогичен протоколу с подтверждением, но в ответ на команду передается простейший пакет ОК. Все изменения во внутреннем состоянии рассылаются как пакеты INFO.
+ проще ПО на устройстве
- несколько больший поток данных по УАРТ
- невозможно контроллировать обновление параметра для конкретной команды
* МОЖНО использовать PUSH-рассылку. Уведомления рассылаются в порядке генерации.


1.	Таск модифицирует набор внутренних данных. При этом данные используются только самим таском. Никаких средств синхронизации не требуется.
	Если данные как-то используются в ISR, может потребоваться запрещение конкретного прерывания, если данные в наборе должны меняться все вместе,
	либо операция модификации неатомарная.
	
2.	Таск модифицирует набор внутренних данных. При этом данные используются как самим таском, так и другими тасками. В этом случае требуется
	примитив синхронизации. Данные модифицируются только самим таском, отсюда не нужно использовать синхронизацию при чтении данных таском.
	Другое дело при чтении данных другим таском. В этом случае может сложиться 2 типа конфликтных ситуаций. Проблема возникнет, когда
		- другой таск будет читать данные, а первый вклинится и произведет модификацию. В этом случае читающий таск получит ерунду.
		- пишущий таск модифицирует данные, читающий вклинивается и читает частично обновленные данные.
	Проблема возникает, когда модификация данных не атомарна, либо данные используются читающим таском в нескольких местах.
	В этом случае нужно использовать мьютекс:
		- пишущий таск захватывает примитив только перед модификацией данных. Отпускает после модификации.
		- читающий таск захватывает примитив перед чтением. Отпускает после чтения.
	Сихронизацию можно упростить, если 
		- пишущий таск имееет более высокий приоритет. В этом случае достаточно обернуть чтение в критическую секцию.
		- читающий таск имеет более высокий приоритет. Достаточно обернуть запись в критическую секцию.
	Проблема не возникает, если модификация данных вызвана читающим таском с более низким приоритетом, чем у пишущего, при этом читающий таск один.

	
-------------------------------------
Данные, которые должны считываться по УАРТ когерентно:
	- канал, 

	- установка тока, текущий диапазон тока, макс. и мин. пределы тока для обоих диапазонов, канал
	- установка напряжения, макс. и мин. пределы регулировки.